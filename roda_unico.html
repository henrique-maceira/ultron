<!DOCTYPE html>
<html lang="pt-br">
<head>
	<script src="https://kit.fontawesome.com/b9da8a6bf5.js" crossorigin="anonymous"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
	<meta charset="utf-8">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<meta content="" name="description">
	<meta content="" name="keywords">
    <!-- ícones -->
	<link href="assets/img/favicon.png" rel="icon">
	<link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon"> 
    <!-- fonte -->
	<link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet'> 	<!-- Fonte dos títulos -->
    <!-- LIBS pyscript -->
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    </head>
<body>
  {% extends "base.html"%}
  {% block content %}
  <div class="container text-center p-5">
    <h1>Teste</h1>
    <input type="text" id="test-input"/>
    <button id="test-button" py-click=opcao()>Escolha uma das opções</button>
    <!-- <p id="test-output"></p> -->
    <py-config>
      packages = ["pandas"]
    </py-config>
    <py-script>
      def opcao(*args, **kwargs):
        test_text = Element("test-input").element.value
        js.console.log(test_text)
        <!-- Element("test-output").element.innerHTML = test_text -->
    </py-script>
  </div>
  <py-script>

  path_excel = 'C:\\Users\\henri\\Desktop\\ULTRON\\'
  path_bucket = 'C:\\Users\\henri\\Desktop\\ULTRON\\Teste_motor\\'

  df = pd.read_excel(path_excel + 'Pasta1.xlsx', sheet_name= 'TESTE')
  df = df[~(df.tipo.isna())].copy()

  tipo = df.tipo.tolist()
  id_processo = df.id_processo.tolist()
  nome_processo = df.nome_processo.tolist()

  while True:
      print('\nSelecione uma Opção:')
      print('\n[1]Visualizar lista de processos')
      print('\n[2]Digitar codigo do processo para execucao')
      print('\n[3]Pesquisar trecho do nome')
      print('\n[4]Atualizar relacao de processos')

      opcao = input('\nOpcao: ')
    
      if opcao == '1':
          print('\nProcessos cadastrados:\n')
          print('ID\tTIPO     \tNOME')
          for x,y,z in zip(id_processo, tipo, nome_processo):
              if y == 'email':
                  y ='email   '
              print(f'[{x}]\t{y}\t{z}')
      elif opcao == '2':
          cod_proc = input('\nDigite o ID do processo: ')
          if len([proc for proc in id_processo if cod_proc.upper() in id_processo]) == 0:
              print('\n ID invalido. Tente novamente.')
          else:
              print(cod_proc)
              nome = df[df.id_processo == cod_proc.upper()].nome_processo.iloc[0]
              confirmacao = input(f'Confirma a execucao de {cod_proc.upper()} - {nome}? (S/N)')
              if confirmacao.upper() == 'S':
                  f = open(path_bucket + cod_proc.upper() + '.txt', 'w')
                  f.close()
                  print('\nProcesso enviado para fila de execucao!')
              else:
                  print('\nOrdem cancelada.')
  </py-script>
    





  {% endblock %}
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
 
  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
</body>
</html>
